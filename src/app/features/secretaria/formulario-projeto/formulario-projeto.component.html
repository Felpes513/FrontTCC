<h2>{{ tituloPagina }}</h2>

<div class="editor-grid">
  <div class="col-form">
    <form class="form-container" (ngSubmit)="salvarProjeto()" *ngIf="projeto">
      <!-- Nome do Projeto -->
      <label for="titulo"><i class="fas fa-book"></i> Título do Projeto</label>
      <input
        id="titulo"
        type="text"
        [(ngModel)]="projeto.titulo_projeto"
        name="titulo_projeto"
        required
        [disabled]="isOrientadorMode"
      />

      <!-- Resumo do Projeto -->
      <label for="resumo"
        ><i class="fas fa-align-left"></i> Resumo do Projeto</label
      >
      <textarea
        id="resumo"
        [(ngModel)]="projeto.resumo"
        name="resumo"
        required
        [disabled]="isOrientadorMode"
      ></textarea>

      <!-- Filtro de Orientador -->
      <label for="buscaOrientador"
        ><i class="fas fa-search"></i> Buscar Orientador</label
      >
      <input
        id="buscaOrientador"
        type="text"
        [(ngModel)]="buscaOrientador"
        (input)="filtrarOrientadores()"
        name="busca_orientador"
        placeholder="Digite o nome do orientador"
        [disabled]="isOrientadorMode"
      />

      <!-- Selecionar Orientador -->
      <label for="selectOrientador"
        ><i class="fas fa-user-tie"></i> Selecionar Orientador</label
      >
      <select
        id="selectOrientador"
        [(ngModel)]="orientadorSelecionadoId"
        (change)="selecionarOrientador($event)"
        required
        name="orientadorSelecionadoId"
        [disabled]="isOrientadorMode"
      >
        <option value="">-- Selecione --</option>
        <option
          *ngFor="let orientador of orientadoresFiltrados"
          [value]="orientador.id"
        >
          {{ orientador.nome_completo }}
        </option>
      </select>

      <!-- E-mail do Orientador -->
      <label for="email_orientador"
        ><i class="fas fa-envelope"></i> E-mail do Orientador</label
      >
      <input
        id="email_orientador"
        type="email"
        [value]="emailOrientador"
        name="email_orientador"
        readonly
      />

      <!-- Campus -->
      <label for="selectCampus"><i class="fas fa-building"></i> Campus</label>
      <select
        id="selectCampus"
        [(ngModel)]="campusSelecionadoId"
        (change)="selecionarCampus($event)"
        required
        name="campusSelecionadoId"
        [disabled]="isOrientadorMode"
      >
        <option value="">-- Selecione --</option>
        <option
          *ngFor="let campus of campusFiltrados"
          [value]="campus.id_campus"
        >
          {{ campus.campus }}
        </option>
      </select>

      <!-- Bolsa do Projeto -->
      <label for="selectBolsa"><i class="fas fa-coins"></i> Bolsa</label>
      <select
        id="selectBolsa"
        [(ngModel)]="projeto.tipo_bolsa"
        name="tipo_bolsa"
        [disabled]="isOrientadorMode"
      >
        <option [ngValue]="null">-- Sem bolsa --</option>
        <option value="PIBIC">PIBIC</option>
        <option value="PIBITI">PIBITI</option>
        <option value="FAPESP">FAPESP</option>
        <option value="CNPq">CNPq</option>
        <option value="Outra">Outra</option>
      </select>

      <!-- ============================== -->
      <!-- Uploads dentro do formulário   -->
      <!-- ============================== -->
      <div class="upload-section" *ngIf="modoEdicao && !isOrientadorMode">
        <h3><i class="fas fa-file-upload"></i> Enviar documentos do projeto</h3>

        <!-- DOCX -->
        <div class="upload-row">
          <label for="docxFile"
            ><i class="fas fa-file-word"></i> Projeto (.docx)</label
          >
          <div class="upload-controls">
            <input
              type="file"
              id="docxFile"
              accept=".docx"
              (change)="onFileSelected($event, 'docx')"
              aria-label="Selecionar arquivo DOCX"
            />
            <div class="upload-buttons">
              <button
                type="button"
                class="btn-upload"
                (click)="enviarArquivo('docx')"
                [disabled]="!arquivoDocx"
                title="Enviar DOCX"
              >
                <i class="fas fa-upload"></i> Upload
              </button>
              <button
                type="button"
                class="btn-download"
                (click)="baixarArquivo('docx')"
                title="Baixar DOCX"
              >
                <i class="fas fa-download"></i> Baixar
              </button>
            </div>
          </div>
          <small class="hint" *ngIf="!arquivoDocx"
            >Selecione um arquivo .docx para habilitar o upload.</small
          >
        </div>

        <!-- PDF -->
        <div class="upload-row">
          <label for="pdfFile"
            ><i class="fas fa-file-pdf"></i> Projeto (.pdf)</label
          >
          <div class="upload-controls">
            <input
              type="file"
              id="pdfFile"
              accept=".pdf"
              (change)="onFileSelected($event, 'pdf')"
              aria-label="Selecionar arquivo PDF"
            />
            <div class="upload-buttons">
              <button
                type="button"
                class="btn-upload"
                (click)="enviarArquivo('pdf')"
                [disabled]="!arquivoPdf"
                title="Enviar PDF"
              >
                <i class="fas fa-upload"></i> Salvar
              </button>
              <button
                type="button"
                class="btn-download"
                (click)="baixarArquivo('pdf')"
                title="Baixar PDF"
              >
                <i class="fas fa-download"></i> Baixar
              </button>
            </div>
          </div>
          <small class="hint" *ngIf="!arquivoPdf"
            >Selecione um arquivo .pdf para habilitar o upload.</small
          >
        </div>
      </div>

      <!-- Ações -->
      <div class="form-actions" *ngIf="!isOrientadorMode">
        <button type="submit">
          <i class="fas fa-save"></i> {{ textoBotao }}
        </button>
        <button type="button" class="btn-cancel" (click)="voltar()">
          <i class="fas fa-arrow-left"></i> Cancelar
        </button>
      </div>

      <div class="form-actions" *ngIf="isOrientadorMode">
        <button type="button" class="btn-cancel" (click)="voltar()">
          <i class="fas fa-arrow-left"></i> Voltar
        </button>
      </div>
    </form>
  </div>

  <!-- COLUNA DIREITA -->
  <div class="col-inscritos" *ngIf="projetoId > 0">
    <app-listagem-alunos
      [projetoId]="projetoId"
      [modo]="isOrientadorMode ? 'ORIENTADOR' : 'SECRETARIA'"
    >
    </app-listagem-alunos>
  </div>
</div>
